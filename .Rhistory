y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
function (test, yes, no)
)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
cbind(W, matrix(0,p,r)
)
Wo
matrix(0,p,ry)
cbind(matrix(0,q,r), C, matrix(0,q,rx), Co)
cbind(a, b, matrix(0,1,rx+ry))
blockm(SigT, SigT%*%B, SigU)
SigT
SigT%*%B
SigU
params_true$SigU
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
params_true$SigH
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
params_true
fit$params
crossprod(params_true$W, fit$params$W
)
crossprod(params_true$C, fit$params$C)
crossprod(params_true$Tt, fit$params$Tt)
crossprod(params_true$Wo, fit$params$Wo)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit$debug
sapply(fit$debug, function(e) e$a)
lapply(fit$debug, function(e) e$a)
params_true$a
fit$debug
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit$logl
lapply(fit$debug, function(e) e$a)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit$debug
fit$logl
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit$logl
lapply(fit$debug, function(e) e$a)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit$logl
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
params_max
params_next
params_true
params_next
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit$logl
fit$debug
params_true
fit$debug[[300]]
fit$debug[[400]]
fit$debug[[500]]
fit$debug[[550]]
fit$debug[[505]]
fit$debug[[510]]
fit$debug[[515]]
fit$debug[[525]]
fit$debug[[528]]
fit$debug[[538]]
fit$debug[[532]]
fit$debug[[530]]
fit$debug[[528]]
fit$debug[[529]]
fit$debug[[530]]
fit$debug[[531]]
fit$debug[[532]]
fit$debug[[531]]
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit$logl
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit$debug
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
source('~/Mygit/Supervised_PO2PLS/SuPO2PLS.R')
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
fit_o2 <- PO2PLS::PO2PLS(X, Y, r, rx, ry, steps = 3000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
for(i in 1:100){
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 1000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
}
for(i in 1:100){
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 10000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
}
for(i in 1:100){
x <- matrix(rnorm(p*N), N,p)
y <- matrix(rnorm(q*N), N,q)
z <- rnorm(N)
params_true <- generate_params(x, y, z, r, rx, ry, alpha = 0.1, type='o2m')
dat <- generate_data(N, params_true)
dim(dat)
X <- dat[,1:p]
Y <- dat[,(p+1):(p+q)]
Z <- dat[,p+q+1]
rm(x,y,z)
fit <- Su_PO2PLS(X, Y, Z, r, rx, ry, steps = 10000, tol = 1e-6, init_param='o2m',
orth_type = "SVD", random_restart = FALSE)
}
gc()
